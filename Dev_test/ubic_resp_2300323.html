<!DOCTYPE html>
{% extends "layout.html" %}
{% block content_reps %}
{% if session['id'] == 'zenka' %}

<html>
  <head>
    <meta charset="UTF-8">
    <script type=text/javascript>
      window.onload = function() {
        var para = document.location.href.split("/");

        const elements = document.querySelectorAll("tr");
        change_btn_color();

        if ( para[3] == 'ubic1' ) {
          elements[0].style.backgroundColor = "#aed4e4";
          
        } else if ( para[3] == 'ubic2' ) {
          elements[0].style.backgroundColor = "#d3c3ff";
          document.getElementById("ear").style.backgroundColor = "#d3c3ff";

        } else if ( para[3] == 'ubic3' ) {
          elements[0].style.backgroundColor = "#e9c4bb";
          document.getElementById("ear").style.backgroundColor = "#e9c4bb";
        };

        var op = setInterval(function() {     // tableì„ ê°±ì‹ 
          date = new Date(); 
          year = date.getFullYear(); 
          month = String(date.getMonth() + 1).padStart(2, "0");
          day = String(date.getDate()).padStart(2, "0");
          hour = String(date.getHours()).padStart(2, "0");
          minute = String(date.getMinutes()).padStart(2, "0");
          second = String(date.getSeconds()).padStart(2, "0");
          document.getElementById("now").innerHTML = year + "ë…„" + month + "ì›”" + day + "ì¼ " + hour + ":" + minute + ":" + second;
        }, 1000);

        var repsck_url = "/" + para[3] + "/ubic_repsck";      // ìœ ì €ì•„ì´ë”” í™•ì¸
        var op = setInterval(function() {     // í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰ì—¬ë¶€ ì²´í¬ìœ„í•œ ë°ì´í„° ê°±ì‹ 
          $.ajax({
            url: repsck_url,
            //headers: {'X-CSRFToken': csrftoken,},
            type: 'POST',     // ì „ì†¡ë°©ì‹ 'POST' ì§€ì •
            //contentType: 'application/x-www-form-urlencode; charset=UTF-8',
            dataType: 'json',     // ë°ì´í„° íƒ€ì… ì§€ì •
            data : { 
              data: "AJAX",
            },
            success: function (rdata) {
              // alert(rdata['ob_ckw'])
              if (rdata['ob_ckw'] == true) {
                ob_ckw = true;
                // var td = document.querySelector("#ob_td");
                // td.innerHTML = '<marquee behavior="alternate" scrollamount="6" style="color: #29a834eb;">â‰¡</marquee>';
                document.getElementById('ob_stt').checked = true;
                document.getElementById('ob_rstt').classList.replace("obsstp", "obsstt");
              } else {
                ob_ckw = false;
                document.getElementById('ob_stp').checked = true;
                document.getElementById('ob_rstt').classList.replace("obsstt", "obsstp");
              }
              if (rdata['all_ckw'] == true) {
                all_ckw = true;
                document.getElementById('ubic_stt').checked = true;
                document.getElementById('ubic_rstt').classList.replace("obsstp_p", "obsstt");
                document.getElementById('ubic_rstt').classList.replace("obsstp", "obsstt");
              } else {
                all_ckw = false;
                document.getElementById('ubic_stp').checked = true;
                document.getElementById('ubic_rstt').classList.replace("obsstt", "obsstp_p");
                document.getElementById('ubic_rstt').classList.replace("obsstp", "obsstp_p");
              }
              if ((rdata['prr_ckw'] == false) && (rdata['pbb_ckw'] == false) && (rdata['pss_ckw'] == false) && (rdata['myc_ckw'] == false)) {
                all_ckw = false;
                document.getElementById('ubic_stp').checked = true;
                document.getElementById('ubic_rstt').classList.replace("obsstp_p", "obsstp");
                document.getElementById('ubic_rstt').classList.replace("obsstt", "obsstp");
              }
              if (rdata['prr_ckw'] == true) {
                prr_ckw = true;
                document.getElementById('prr_stt').checked = true;
                document.getElementById('prr_rstt').classList.replace("obsstp", "obsstt");
              } else {
                prr_ckw = false;
                document.getElementById('prr_stp').checked = true;
                document.getElementById('prr_rstt').classList.replace("obsstt", "obsstp");
              }
              if (rdata['wrun_ckw'] == true) {
                wrun_ckw = true;
                // document.getElementById('wrun_stt').checked = true;
                // document.getElementById('wrun_rstt').classList.replace("obsstp", "obsstt");
              } else {
                wrun_ckw = false;
                // document.getElementById('wrun_stp').checked = true;
                // document.getElementById('wrun_rstt').classList.replace("obsstt", "obsstp");
              }
              if (rdata['pbb_ckw'] == true) {
                pbb_ckw = true;
                document.getElementById('pbb_stt').checked = true;
                document.getElementById('pbb_rstt').classList.replace("obsstp", "obsstt");
              } else {
                pbb_ckw = false;
                document.getElementById('pbb_stp').checked = true;
                document.getElementById('pbb_rstt').classList.replace("obsstt", "obsstp");
              }
              if (rdata['pss_ckw'] == true) {
                pss_ckw = true;
                document.getElementById('pss_stt').checked = true;
                document.getElementById('pss_rstt').classList.replace("obsstp", "obsstt");
              } else {
                pss_ckw = false;
                document.getElementById('pss_stp').checked = true;
                document.getElementById('pss_rstt').classList.replace("obsstt", "obsstp");
              }
              if (rdata['myc_ckw'] == true) {
                myc_ckw = true;
                document.getElementById('myc_stt').checked = true;
                document.getElementById('myc_rstt').classList.replace("obsstp", "obsstt");
              } else {
                myc_ckw = false;
                document.getElementById('myc_stp').checked = true;
                document.getElementById('myc_rstt').classList.replace("obsstt", "obsstp");
              }
              // alert(ob_ckw)
            },
            error: function (rdata) {
              // alert("ajax í†µì‹ ì‹¤íŒ¨");
              location.href = location.href
            }
          }) // ajax ë
        }, 3000); // setInterval ë

      }
      function page_move(obj){
        var para = document.location.href.split("/");
        var url1 = "/" + para[3]
        var url2 = "/" + para[3] + "/ubic_ear";
        var url3 = "/" + para[3] + "/ubic_mear";
        var url4 = "/" + para[3] + "/ubic_bal";
        // alert(obj);
        var cont_tmp = obj.innerHTML.split('<b>')[1];
        var cont = cont_tmp.split('</b>')[0];
        // alert(cont);
        if ( cont == "ìì‚°ì •ë³´" ){
          location.href = url1;
        } else if ( cont == "ì¼ë³„ë‚´ì—­" ) {
          location.href = url2;
        } else if ( cont == "ì›”ë³„ë‚´ì—­" ) {
          location.href = url3;
        } else {
          location.href = url4;
        }        
      }

      function reps(obj, coin_name){     // í”„ë¡œì„¸ìŠ¤ ì¬ì‹¤í–‰
        var para = document.location.href.split("/");
        var reps_url = "/" + para[3] + "/ubic_reps";      // ìœ ì €ì•„ì´ë”” í™•ì¸
        const proc_name = $("#" + obj).parent().parent().children(0).first().text();
        const cmdh = obj.split('_')[0];
        const cmdb = obj.split('_')[1];
        alert(obj);
        alert(coin_name);
        // alert(reps_url);

        // alert(obj.split('_')[0], obj.split('_')[1]);
        if (cmdb == "rstt") {
          var x = confirm(proc_name + " í”„ë¡œì„¸ìŠ¤ë¥¼ ì¬ì‹¤í–‰ í• ê¹Œìš”? ");
        } else if (cmdb == "stt") {
          var x = confirm(proc_name + " í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹¤í–‰ í• ê¹Œìš”? ");
        } else if (cmdb == "stp") {
          var x = confirm(proc_name + " í”„ë¡œì„¸ìŠ¤ë¥¼ ì •ì§€ í• ê¹Œìš”? ");
        } else if (cmdb == "expr") {
          var x = confirm(coin_name + " ë¥¼ ì‚­ì œ í• ê¹Œìš”? ");
        } else if (cmdb == "expa") {
          var x = prompt("ì¶”ê°€í•  ì¢…ëª©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”!","KRW-");
        }

        if ( x ) {
          $.ajax({
                url: reps_url,
                //headers: {'X-CSRFToken': csrftoken,},
                type: 'POST',
                //contentType: 'application/x-www-form-urlencode; charset=UTF-8',
                dataType: 'json',
                data : {
                  cmdh: cmdh, cmdb: cmdb, xdata: x, cndata: coin_name
                },
                success: function (rdata) {
                    if ( cmdb == "rstt" ) {
                      alert("ì¬ì‹¤í–‰ ì™„ë£Œ!");
                    } else if ( cmdb == "stt") {
                      alert("ì‹¤í–‰ ì™„ë£Œ!");
                    } else if ( cmdb == "stp") {
                      alert("ì •ì§€ ì™„ë£Œ!");
                    } else if ( cmdb == "expr") {
                      alert(coin_name + " ì‚­ì œ ì™„ë£Œ!");
                    } else if ( cmdb == "expa") {
                      alert(coin_name + " ì¶”ê°€ ì™„ë£Œ!");
                    }
                },
                error: function (rdata) {
                    alert("ajax í†µì‹ ì‹¤íŒ¨");
                }
            });
        
        } else {
            alert("ì·¨ì†Œ!")
        }
      }
    </script>
  </head>

  <style>
  </style>

  <body>
    <div class="flex-container center">      <!-- container 1s-->
      <div class="flex-item1">
        <a href='{{ url_for('logout') }}' style="text-decoration:none;">
          <button class=" button_up" id = "acc_logout" style="background-color:#ffffff!important; color: #1a8dbb;">
            <p style="font-size: 0.85em; line-height:1.1px;"><b>UBiCat</b></p>
            <p style="font-size: 0.75em; line-height:1.1px;">ë¡œê·¸ì•„ì›ƒ</p>
          </button>
        </a>
      </div>  
      <div class="flex-item1">
        <button class="font2 button_up" id="bal" onclick="page_move(this);" style="background-color:#ffffff!important; color: #1a2abb;">
            <b>ìì‚°ì •ë³´</b>
        </button>
      </div>  
      <div class="flex-item1" >
        <button class="font2 button_up" id="ear" onclick="page_move(this);" style="background-color:#ffffff!important; color: #1a2abb;">
            <b>ì¼ë³„ë‚´ì—­</b>
        </button>
      </div>
      <div class="flex-item1" >
        <button class="font2 button_up" id="mear" onclick="page_move(this);" style="background-color:#ffffff!important; color: #1a2abb;">
            <b>ì›”ë³„ë‚´ì—­</b>
        </button>
      </div>
      <div class="flex-item1" >
        {% if session['id'] == 'zenka' %}
        <button class="font2 button_up" id="m" onclick="page_move(this);" style="background-color:#ffffff!important; color: #1a2abb;">
        {% else %}
        <button class="font2 button_up" id="m" style="background-color:#ffffff!important; color: #1a2abb;">
        {% endif %}
            <b>M</b>
        </button>
      </div>
    </div>      <!-- container 1e-->

    <div class="flex-container3_2 center">
      <div class="flex-item3_1 font1 div_r">
        <table>
          <tr>
            <th class="pro_n">
                í”„ë¡œì„¸ìŠ¤
            </th>
            <th class="pro_n">
                ì¬ì‹¤í–‰
            </th>
            <th class="pro_n">
                ì‹¤í–‰
            </th>
            <th class="pro_n">
                ì •ì§€
            </th>
          </tr>
          {% if ob_ckw == True %}
            <tr>
              <td>ê°ì‹œ</td>
              <td id="ob_td">
                  <button class="obsstt" id="ob_rstt" name="ch_ob" > â™» </button>
                  <!-- <marquee behavior="alternate" scrollamount="6" style="color: #29a834eb;">â‰¡</marquee> -->
              </td>
              <td>
                  <input type="radio" id="ob_stt" name= "ch_ob" onclick="reps(this.id)" checked />
              </td>
              <td>
                  <input type="radio" id="ob_stp" name= "ch_ob" onclick="reps(this.id)" />
              </td>
            </tr>
          {% else %}
            <tr>
              <td>ê°ì‹œ</td>
              <td id="ob_td">
                  <button class="obsstp" id="ob_rstt" name="ch_ob" > â™» </button>
                  <!-- <marquee behavior="alternate" scrollamount="6" style="color: #29a834eb;">â‰¡</marquee> -->
              </td>
              <td>
                  <input type="radio" id="ob_stt" name= "ch_ob" onclick="reps(this.id)" />
              </td>
              <td>
                  <input type="radio" id="ob_stp" name= "ch_ob" onclick="reps(this.id)" checked />
              </td>
            </tr>
          {% endif %}
          {% if all_ckw == True %}
            <tr>
              <td>ğ“†© ì „ì²´ ğ“†ª</td>
              <td>
                  <button class="obsstt" id="ubic_rstt" name= "ch_po" onclick= "reps(this.id)"> â™» </button>
              </td>
              <td>
                  <input type="radio" id="ubic_stt" name= "ch_po" onclick="reps(this.id)" checked />
              </td>
              <td>
                  <input type="radio" id="ubic_stp" name= "ch_po" onclick="reps(this.id)"/>
              </td>
            </tr>
          {% else %}
            <tr>
              <td>( ì „ì²´ )</td>
              <td>
                  <button class="obsstp_p" id="ubic_rstt" name= "ch_po" onclick= "reps(this.id)"> â™» </button>
              </td>
              <td>
                  <input type="radio" id="ubic_stt" name= "ch_po" onclick="reps(this.id)" />
              </td>
              <td>
                  <input type="radio" id="ubic_stp" name= "ch_po" onclick="reps(this.id)" checked />
              </td>
            </tr>
          {% endif %}
          {% if prr_ckw == True %}
            <tr>
              <td>ê³µí†µ</td>
              <td>
                  <button class="obsstt" id="prr_rstt" name = "ch_prr" onclick="reps(this.id)" > â™» </button>
              </td>
              <td>
                  <input type="radio" id="prr_stt" name = "ch_prr" onclick="reps(this.id)" checked />
              </td>
              <td>
                  <input type="radio" id="prr_stp" name = "ch_prr" onclick="reps(this.id)" />
              </td>
            </tr>
          {% else %}
            <tr>
              <td>ê³µí†µ</td>
              <td>
                  <button class="obsstp" id="prr_rstt" name = "ch_prr" onclick="reps(this.id)" > â™» </button>
              </td>
              <td>
                  <input type="radio" id="prr_stt" name = "ch_prr" onclick="reps(this.id)" />
              </td>
              <td>
                  <input type="radio" id="prr_stp" name = "ch_prr" onclick="reps(this.id)" checked />
              </td>
            </tr>
          {% endif %}
          {% if wrun_ckw == True %}
            <tr>
              <td>ì›¹ì„œë²„</td>
              <td>
                  <button class="obsstt" id="wrun_rstt" name = "ch_wrun" onclick="reps(this.id)" > â™» </button>
              </td>
              <td>
                  <!-- <input type="radio" id="wrun_stt" name = "ch_wrun" onclick="reps(this.id)" checked /> -->
                  ğ“†©â¦ğ“†ª
              </td>
              <td>
                  <!-- <input type="radio" id="wrun_stp" name = "ch_wrun" onclick="reps(this.id)" /> -->
                  â•³
              </td>
            </tr>
          {% else %}
            <tr>
              <td>ì›¹ì„œë²„</td>
              <td>
                  <button class="obsstp" id="wrun_rstt" name = "ch_wrun" onclick="reps(this.id)" > â™» </button>
              </td>
              <td>
                  <!-- <input type="radio" id="wrun_stt" name = "ch_wrun" onclick="reps(this.id)" checked /> -->
              </td>
              <td>
                  <!-- <input type="radio" id="wrun_stp" name = "ch_wrun" onclick="reps(this.id)" /> -->
              </td>
            </tr>
          {% endif %}
          {% if pbb_ckw == True %}
            <tr>
              <td>ë§¤ìˆ˜</td>
              <td>
                  <button class="obsstt" id="pbb_rstt" name = "ch_pbb" onclick="reps(this.id)" > â™» </button>
              </td>
              <td>
                  <input type="radio" id="pbb_stt" name = "ch_pbb" onclick="reps(this.id)" checked />
              </td>
              <td>
                  <input type="radio" id="pbb_stp" name = "ch_pbb" onclick="reps(this.id)" />
              </td>
            </tr>
          {% else %}
            <tr>
              <td>ë§¤ìˆ˜</td>
              <td>
                  <button class="obsstp" id="pbb_rstt" name = "ch_pbb" onclick="reps(this.id)" > â™» </button>
              </td>
              <td>
                  <input type="radio" id="pbb_stt" name = "ch_pbb" onclick="reps(this.id)" />
              </td>
              <td>
                  <input type="radio" id="pbb_stp" name = "ch_pbb" onclick="reps(this.id)" checked />
              </td>
            </tr>
          {% endif %}
          {% if pss_ckw == True %}
            <tr>
              <td>ë§¤ë„</td>
              <td>
                  <button class="obsstt" id="pss_rstt" name = "ch_pss" onclick="reps(this.id)" > â™» </button>
              </td>
              <td>
                  <input type="radio" id="pss_stt" name = "ch_pss" onclick="reps(this.id)" checked />
              </td>
              <td>
                  <input type="radio" id="pss_stp" name = "ch_pss" onclick="reps(this.id)" />
              </td>
            </tr>
          {% else %}
            <tr>
              <td>ë§¤ë„</td>
              <td>
                  <button class="obsstp" id="pss_rstt" name = "ch_pss" onclick="reps(this.id)" > â™» </button>
              </td>
              <td>
                  <input type="radio" id="pss_stt" name = "ch_pss" onclick="reps(this.id)" />
              </td>
              <td>
                  <input type="radio" id="pss_stp" name = "ch_pss" onclick="reps(this.id)" checked />
              </td>
            </tr>
          {% endif %}
          {% if myc_ckw == True %}
            <tr>
              <td>ìë£Œìƒì„±</td>
              <td>
                  <button class="obsstt" id="myc_rstt" name = "ch_myc" onclick="reps(this.id)" > â™» </button>
              </td>
              <td>
                  <input type="radio" id="myc_stt" name = "ch_myc" onclick="reps(this.id)" checked />
              </td>
              <td>
                  <input type="radio" id="myc_stp" name = "ch_myc" onclick="reps(this.id)" />
              </td>
            </tr>
          {% else %}
            <tr>
              <td>ìë£Œìƒì„±</td>
              <td>
                  <button class="obsstp" id="myc_rstt" name = "ch_myc" onclick="reps(this.id)" > â™» </button>
              </td>
              <td>
                  <input type="radio" id="myc_stt" name = "ch_myc" onclick="reps(this.id)" />
              </td>
              <td>
                  <input type="radio" id="myc_stp" name = "ch_myc" onclick="reps(this.id)" checked />
              </td>
            </tr>
          {% endif %}
        </table>
      </div>
    </div>
    {% if session['id'] == 'zenka' %}
    <div class= "flex-container3_3">
      <div class="flex-item3_1 font1 div_r">
        <table>
          <tr>
            <th class="pro_n" style="background-color:#aed4e4">
              ì‹ ê·œ ë§¤ìˆ˜ ì œì™¸ ì¢…ëª©
            </th>
            <th class="pro_n" style="background-color:#aed4e4">
              í•­ëª©ì œê±°
            </th>
            <th class="pro_n" style="background-color:#aed4e4">
              <button id=exp_expa onclick="reps(this.id)" style="font-size: 1em; border-radius: 15px; background-color:#375ed5d5!important; border-color: #ffffff; color: #ffffff; line-height:60%; padding: 4px 4px 4px 4px;" >ì¶”ê°€</button>
            </th>
          </tr>

          {% for name in ext_B %}
          <tr>
            <td>
              {{ name }}
            </td>
            <td colspan="2">
              <button id=exp_expr onclick="reps(this.id, '{{name}}')" style="font-size: 1em; border-radius: 10px; background-color:#fb9d78d5!important; border-color: #ffffff; color: #ffffff; line-height:50%; padding: 4px 4px 4px 4px;" >ì‚­ì œ</button>
            </td>
          </tr>
          {% endfor %}
        </table>
      </div>
    </div>
    {% endif %}

    {% if session['id'] == 'zenka' %}
    <div class="flex-container4 center">      <!-- container 4s-->
      <div class="flex-item4">
        <a href='/ubic1/ubic_reps' style="text-decoration:none;">
          <button class="font2 button_up" id = "acc_move1">
              <b>Zenky</b>
          </button>
        </a>
      </div>
      <div class="flex-item4">
        <a href='/ubic1/ubic_reps' style="text-decoration:none;">
          <button class="font2 button_up" id = "acc_move2">
            <b>Butys</b>
          </button>
        </a> 
      </div>
      <div class="flex-item4">
        <a href='/ubic1/ubic_reps' style="text-decoration:none;">
          <button class="font2 button_up" id = "acc_move3">
              <b>Liebe</b>
          </button>
        </a>
      </div>
    </div>      <!-- container 4e-->
    {% endif %}

  </body>
</html>
{% else %}
<script>
  alert("ì˜ëª»ëœ í˜ì´ì§€ì…ë‹ˆë‹¤");
  window.location = "/error/500";
</script>
{% endif %}
{% endblock %}